###################################################
## FILENAME:    BDdate.sh
## AUTHOR:      Jimmy Lin (u5223173) 
## DATE:        2013-05-23
## DESCRIPTION: 
##    Homework 12 1b of COMP2100
##
###################################################
## Edited by MacVim
## Documentation autogenerated by snippet
###################################################

## initialise the temporary variables
count=0
date=0
## loop through all queries
while read date
do 
    ## string that stores matched pieces
    str=$(grep ".*${date}.*" ./BDlist.txt)
    ## number of such pieces
    count=$( echo "$str" | wc -l)
    ## basic branching for birthday or birthdays
    if [[  $count -eq 1 ]]; then
        ## since echo empty string will return empty line,
        ## we need to do more specific braching
        word=$( echo "$str" | wc -w)
        if [[ word -eq 0 ]]; then
            ## response to query
            echo The $date has 0 birthday
            ## go to the next query, no empty line output
            continue 
        else
            ## resopnse to query for 1 birthday
            echo The $date has 1 birthday
        fi
    elif [[ $count -gt 1 ]]; then
        ## response to query for 2 birthday
        echo The $date has $count birthdays
    else 
        ## exception
        echo error occurs.
    fi
    ## provide detailed information
    ##    1. display content in variable "str"
    ##    2. choose the field of email and name
    ##    3. for each line, provide indents
    ##    4. replace comma with blank
    echo "$str" | cut -f 2,3 -d ',' | awk 'BEGIN {FS=";"} {print "    ",$0 }' | tr ',' " " 
done < "query" ## next query
