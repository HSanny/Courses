%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  THIS TEX FILE IS TO GENERATE PDF FILE FOR 
%%% 
%%%  COPYRIGHT (C) JIMMY LIN, 2013, UT AUSTIN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt,a4paper]{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%  PACKAGES USED IN THIS TEX SOURCE FILE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{geometry,amsthm,amsmath,graphicx,fancyheadings,amsfonts}
\usepackage[colorlinks,
            linkcolor=blue,
            anchorcolor=red,
            citecolor=green
            ]{hyperref}
% for my mac
\IfFileExists{/Users/JimmyLin/.latex/UTA_CS/JS.sty}{ 
    \usepackage{/Users/JimmyLin/.latex/UTA_CS/JS}
    \usepackage{/Users/JimmyLin/.latex/UTA_CS/JSASGN}
}{} 
% for UT's linux machine
\IfFileExists{/u/jimmylin/workspace/Configs/latex/UTA_CS/JS.sty}{
    \usepackage{/u/jimmylin/.latex/UTA_CS/JS} 
    \usepackage{/u/jimmylin/.latex/UTA_CS/JSASGN}
}{} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% MACROS CONTAINING THE FILE INFORMATION
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\COURSE}{CS383C Numerical Analysis}
\renewcommand{\LECTURER}{Robert A. van de Geijn}
\renewcommand{\SECTION}{53180}
\renewcommand{\TASK}{Homework 03}
\renewcommand{\RELEASEDATE}{Sep. 18 2014}
\renewcommand{\DUEDATE}{May. 23 2014}
\renewcommand{\TIMECONSUME}{10 hours}

\renewcommand{\thesection}{Exercise \arabic{section}.}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\renewcommand{\contentsname}{Exercises}
\newtheorem{lemma}{Lemma}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% DOCUMENTATION STARTS FROM HERE 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TITLE PAGE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
    \maketitle
\end{titlepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% CONTENT PAGE: TABLEOFCONTENTS, LISTOFTABLES, LIST OF FIGURES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{center} 
%    \tableofcontents  
%
%    %\listoftables 
%    %\listoffigures
%\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Macros
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\be}{\begin{eqnarray}}
\newcommand{\ee}{\end{eqnarray}}
\newcommand{\no}{\nonumber}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% GENERAL DOCUMENTATION BEGINS 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\setcounter{section}{1}
\section{Show that if $H$ is a reflector, then}
\subsection{$HH=I$}
Since $H$ is a reflector, we have
\be
    H = I - 2 u u ^H 
\ee
where $u$ is unit vector ($||u||_2 = 1$).
\be
    H H &=& (I - 2 u u ^H) (I - 2 u u ^H) \no \\
    &=& I \cdot I - 2 u u^H - 2 u u^H + 4(uu^H) (uu^H) \no \\
    &=& I - 4 u u ^H + 4 ||u||_2 u u ^H \no \\
    &=& I - 4 u u ^H + 4  u u ^H \no \\
    &=& I \label{2.1conclusion} 
\ee
\begin{lemma}
    $ (uu^H) (uu^H) = ||u||_2 u u^H$
\end{lemma}
\begin{proof}
\be
    uu^H = 
\ee
\end{proof}
\subsection{$H=H^H$}
\be
    H^H &=& (I - 2uu^H) ^H \no \\
    &=& I^H - (2uu^H)^H \no\\
    &=& I - 2(u^H)^H u^H  \no\\
    &=& I - 2 u u^H \no\\
    &=& H \label{2.2conclusion} 
\ee
\subsection{$HH^H=I$}
In terms of \eqref{2.2conclusion}, multiply both sides with $H$ and then we
have
\be
    H^H H &=& H H
\ee
Then by \eqref{2.1conclusion}, we have
\be
    H^H H &=& I
\ee

\newpage
\setcounter{section}{3}
\newcommand{\Rn}{\mathbb{R}^n}
\section{Show that if $x \in \Rn,\ v=x \mp ||x||_2 e_0$ and
    $\tau=v^Tv/2$, then $(I-\frac{1}{\tau}vv^T)=\pm||x||_2 e_0$}
We start from the reflector $I-\frac{1}{\tau}vv^T$ on $x$,
\be
    && (I-\frac{1}{\tau}vv^T) x \no \\
    &=& \bigg(I-\frac{2vv^T}{v^T v}\bigg) x \no \\
    &=& \bigg(I-\frac{2(x \mp ||x||_2 e_0)(x \mp ||x||_2 e_0)^T}{(x \mp ||x||_2
        e_0)^T (x \mp ||x||_2 e_0)}\bigg) x \no \\
    &=& \bigg(I - 2 \frac{xx^T\mp ||x||_2(xe_0^T+e_0 x^T)+||x||_2^2 e_0 e_0^T}
    {2||x||_2^2 \mp 2||x||_2 e_0^T x}\bigg) x \no \\
    &=& \bigg(I -  \frac{xx^T\mp ||x||_2(xe_0^T+e_0 x^T)+||x||_2^2 e_0 e_0^T}
    {||x||_2^2 \mp ||x||_2 e_0^T x}\bigg) x \no \\
    &=& \frac{||x||_2^2 \mp ||x||_2 e_0^T x - xx^T\pm ||x||_2(xe_0^T+e_0
        x^T) -||x||_2^2 e_0 e_0^T}
    {||x||_2^2 \mp ||x||_2 e_0^T x} x \no \\
    &=& \frac{||x||_2^2 x \mp ||x||_2 e_0^T x x - xx^T x \pm ||x||_2(xe_0^T+e_0
        x^T)x -||x||_2^2 e_0 e_0^Tx}
    {||x||_2^2 \mp ||x||_2 e_0^T x} \no \\
    &=& \frac{(||x||_2^2 x - xx^T x) +
        (\mp ||x||_2 e_0^T x x  \pm ||x||_2 xe_0^T x) 
        \pm ||x||_2 e_0 x^T x -||x||_2^2 e_0 e_0^Tx}
    {||x||_2^2 \mp ||x||_2 e_0^T x} \no \\
    &=& \frac{ \pm ||x||_2 e_0 x^T x -||x||_2^2 e_0 e_0^Tx}
    {||x||_2^2 \mp ||x||_2 e_0^T x} \no \\
    &=& \frac{ \pm  e_0 x^T x -||x||_2 e_0 e_0^Tx}
    {||x||_2 \mp e_0^T x} \no \\
    &=& \frac{ \pm ||x||_2^2 e_0  -||x||_2 (e_0^Tx) e_0 }
    {||x||_2 \mp e_0^T x} \no \\
    &=& \frac{ \pm (||x||_2 - (e_0^Tx)) ||x||_2 e_0 }
    {||x||_2 \mp e_0^T x} \no \\
    &=& \pm ||x||_2 e_0 
\ee
Note that above derivation frequently makes use of the following lemma.
\begin{lemma}
    For arbitrary vector $a\in\Rn$, $b\in \Rn$, $c\in \Rn$, $ab^T c= (b^T c) a$.
\end{lemma}
\begin{proof}
    \be
       ab^T c &=& 
       \begin{pmatrix}
            a_0 b^T \\
            a_1 b^T \\
            \vdots \\
            a_{n-1} b^T 
       \end{pmatrix} c
       = 
       \begin{pmatrix}
            a_0 b^T c \\
            a_1 b^T c \\
            \vdots \\
            a_{n-1} b^T c 
       \end{pmatrix} 
       = 
       \begin{pmatrix}
           (b^T c) a_0  \\
           (b^T c) a_1  \\
            \vdots \\
           (b^T c) a_{n-1}  
       \end{pmatrix} 
       = (b^T c) 
       \begin{pmatrix}
            a_0  \\
            a_1  \\
            \vdots \\
            a_{n-1}  
       \end{pmatrix}
       = (b^T c) a
    \ee
\end{proof}

\newpage
\section{Complex}

\newpage
\section{Matrix Equivalence}
We start from right hand side
\be
    RHS 
    &=&
        I - \frac{1}{\tau_1} 
        \begin{pmatrix} 0 \\\hline  1 \\\hline u_2 \end{pmatrix}
        \begin{pmatrix} 0 \\\hline 1 \\\hline u_2 \end{pmatrix}^H
        \no \\
    &=& \left(
        I - \frac{1}{\tau_1} 
        \begin{array}{c|c} 
            0 & 0 \\\hline 
            0 & 
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}^H
        \end{array}
    \right)
        \no \\
    &=& \left(
        I - 
        \begin{array} {c|c}
            0 & 0 \\ \hline 
            0 & \frac{1}{\tau_1}
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}^H
    \end{array} 
    \right)
        \no \\
    &=& \left(
    \begin{array}{c|c}
            I & 0 \\ \hline
            0 & I - \frac{1}{\tau_1}
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}
        \begin{pmatrix} 1 \\\hline u_2 \end{pmatrix}^H
    \end{array} 
    \right)
        \no \\
    &=& 
        LHS
\ee
\vspace{1cm}
\setcounter{section}{10}
\section{Expensive Algorithm}
As indicatd by {\bf Theorem 10} in the note, we have cost of the algorithm in
Figure 6 for $A\in\mathbb{C}^{m\times n}$ 
\be
C_{FormQ}(m,n)  = 2mn^2-\frac{2}{3}n^3
\ee
For $m = n$, the cost can be simplified as 
\be
C_{FormQ} (A) = \frac{4}{3} n^3 = \mathbb{O} (n^3) \label{algo:cubic}
\ee
However, if we accumulate $Q$ by using $n$ householder transformation with 
\be
Q = (\hdots((IH_0) H_1) \hdots H_{n-1})
\ee
Then the cost we have is at least 
\be
C_{accumulation} (A) = n^3 \cdot (n-1) = \mathbb{O} (n^4) \label{algo:fourth}
\ee
where $n^3$ comes from each one matrix multiplication, and $n-1$ comes from
the total number of householder matrix $H_i$ ($i\in \mathbb{Z}, i \in
[0,n-1]$). \\
Comparing formula \eqref{algo:cubic} and \eqref{algo:fourth}, it is obvious
that the accumulation method is much more expensive than algorithm in Figure
6. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% General Documentation ends
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
