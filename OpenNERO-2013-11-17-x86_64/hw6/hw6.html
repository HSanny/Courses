<!DOCTYPE HTML>
<html>

<head>
<title>Neuroevolution - Creating a NERO Team for the Tournament</title>
<link rel=stylesheet href="http://www.cs.utexas.edu/~ikarpov/Style/default.css" type="text/css">
</head>

<body>
<h1>Neuroevolution - Creating a NERO Team for the Tournament<br>(due 11:59pm, Dec 03, 2013)</h1>

<p>In this assignment you will use the Human Guided Neuroevolution
extensions for the rtNEAT algorithm to train a team of
<a href="http://code.google.com/p/opennero/">OpenNero</a> agents to
defeat your opponents in battle. We will hold a tournament in class,
where we will pit the teams against each other in an apocalyptic
battle for world domination (or something). Follow the steps below,
unless of course you're comfortable getting destroyed by your
opponents who did.

<p>This homework is a little different in that it does not require
you to do a lot of programming but it does require you to do some
thinking and experimentation. A very important part of this process
is recording what you are trying to do, what your steps are, what
you expected to see, and what you actually observed.

<h3>1. Get OpenNero</h3>

<p><b>OpenNERO has been updated, you will need to re-install/rebuild it for this assignment.</b>.  There is currently not a working Windows binary, 
however the precompiled Mac and Linux(unbuntu 12.04) binaries are available on the <a href="https://code.google.com/p/opennero/downloads/list">Google Code</a>
site.</p>  

<p>If you need the instructions on how to build OpenNERO look <a href="http://code.google.com/p/opennero/wiki/BuildingOpenNero">here</a>.  Note that the dependencies may have changed since the last time you compiled OpenNERO.</p>


<p>To run the training simulator, first start the OpenNERO binary, and
choose the <tt>NERO Training</tt> module from the menu. The NERO simulator will
start, showing a training arena, and a separate Training Window will
open with several tabs, showing the main tab with command buttons.
Click the "New Neuroevolution Team" button to start training a team.

<h3>2. Last year's tournament </h3>

First take a look at the web page for the
<a href="http://code.google.com/p/opennero/wiki/NeroTournamentExercise">2011 tournament </a>.
It has details about the Nero environment, training strategies, rtNEAT etc.

<p>Note, however, that the teams for last year's tournament were trained using a different version of
OpenNero. While they will run in the current version, their performance will likely be different, and
the rankings would not be the same.  Some example teams that work with this year's version of OpenNERO should
be available from this assignment page soon.

<h3>3. Training Interface</h3>

<p><b>SAVE OFTEN</b>. You don't want to accidentally close something and find that your
long-trained team is nowhere to be found. So, after every step, save your team, and take
notes of what you're doing and what the results are.  <I>Note:</I> Make sure that you give your team name a file extension (<tt>.txt</tt> is fine), otherwise when you go to load them OpenNERO won't be able to find the file.</p>

<p><b>TAKE NOTES</b>. Make notes about what behaviors you were trying to train, how close
you got, and what versions of the teams you started/finished with. Make your save names
descriptive enough so that you can remember what they were after you eat a giant turkey
dinner. For your report, you can right click on the graphs and save or copy them for your
notes as well. Many web platforms such as Google Docs or Evernote support free note taking
with images. These notes will make writing your report a breeze. Your future self will 
thank you!

<p><b>TROUBLE?</b> If you should run into trouble or if OpenNero crashes we'd like to know as much
about it as possible! Specifically, please save the file ~/.opennero/nero_log.txt, try to
replicate the problem, and try to remember what exactly you did right before.

<p>Most of the training centers around the <b>Training Window</b>, an external
Java window that acts as a remote control for the OpenNERO program. The only exception
is the <b>Environment Shaping</b>, where you can modify the environment by right-clicking
inside the OpenNERO window and using the menus.

<h4>3a. Adjusting Fitness and Rewards.</h4>

<p>In the <b>Change Rewards</b> tab, you can adjust the reward components
that affect the fitness of the agents. For example, to reward agents that
move closer to the flag, slide the "Approach Flag" slider all the way to
the right (positive) extreme. If, on the other hand, you want both agents
that approach flags and agents that avoid fire, slide those sliders to
similar values. You can also adjust the rewards to negative values to
punish the agents that score highly in the corresponding dimension.

<h4>3b. Monitoring Evolution Progress</h4>

<p>In the <b>Monitor Progress</b> tab, you can see the recent history of
the top performing individual (champ) in the various categories they can
be rewarded. OpenNERO uses a weighted average of Z-scores formula to
combine these fitness components into a single value that reflects the slider
preferences. A history of the slider preferences can be seen in the
<b>Fitness Weights</b> sub-tab under <b>Monitor Progress</b>.

<p>See something interesting in the graphs? <b>SAVE IT!</b> (right click on the chart and select "save"</p>

<h4>3c. Giving Advice</h4>

<p>In the <b>Give Advice</b> tab, you can write miniature programs for your
agents to follow. These programs will be converted to a neural network
structure and spliced into the population of controllers on the field,
changing their behavior. You can see some examples of the advice language
to the right of the text window. You should experiment with different
pieces of advice and their effects on agent behavior, and you can even
investigate the meaning of the sensors and the actions used in the language
defined inside <code>/mods/NERO/NeroEnvironment.py</code>.

<h4>3d. Teaching by Demonstration</h4>

<p>In the <b>Provide Examples</b> tab, you can train your robots by showing them how it's done.
To do so, you can click "Record Example" to launch an agent and control
it with the keyboard to execute the desired behavior. If you like the behavior,
you can then click "Apply Example" to train your population with it.

<h3>4. Train your tournament team</h3>

<p>You're free to use whatever strategy you want to evolve your team, but the steps below
seem to be a good idea.

<h4>4a Evolve flag behavior</h4>

<p>In sandbox, set the flag slider to "approach" and train your team to approach flags in
different places, starting from different spawn locations. Evolve until you're happy.

<h4>4b Flag around the wall</h4>

<p>Next, add a wall and evolve until they find a way around. Keep evolving until you're
confident that the agents will approach the flag even when walls are in the way.

<h4>4c Approach Enemy</h4>

Replace the flag with a static enemy and evolve agents to approach it using the "approach
enemy" slider. Once you're happy, add walls like before and evolve agents that can get
around them.

<h4>4d Approach enemy while firing</h4>

Finally, use the sliders for approaching and for hitting the enemy to evolve agents that
can do all at once: approach and hit the enemy while avoiding obstacles.

<h3>5. Assemble your team</h3>

<p>rtNEAT and RL can come up with many unique solutions to the tasks you give them, and
OpenNero agents (even in the same population) can vary quite a bit, both in terms of what
they do and how well they perform. It's a good idea to assemble your team using the best
individuals from several runs (so your agents solve problems more robustly and so they
don't all do the same thing). Here's how to do that.

<p>The team files (or population files, or genome files) that you save are ASCII text
files, so you can open them with your favorite text editor such as notepad, emacs or
gedit. The basic structure of the file is like this for rtNEAT teams:

<pre>genomestart 120
trait 1 0.112808 0.000000 0.305447 0.263380 0.991934 0.000000 0.306283 0.855288
...
node 1 1 1 1 FriendRadarSensor 3 90 -90 15 0
...
node 21 1 1 3
...
gene 1 1 22 0.041885 0 1.000000 0.041885 1
...
genomeend 120</pre>

<p>Each genome also has a corresponding stats entry elsewhere in the file:</p>

<div><textarea rows="11" cols="80" style="border: none">
<message><content class="edu.utexas.cs.nn.opennero.Genome"
id="120" bodyId="46" fitness="123.000000">
<rawFitness>
  <entry dimension="STAND_GROUND">1.000000</entry>
  <entry dimension="STICK_TOGETHER">2.000000</entry>
  <entry dimension="APPROACH_ENEMY">3.000000</entry>
  <entry dimension="APPROACH_FLAG">4.000000</entry>
  <entry dimension="HIT_TARGET">5.000000</entry>
  <entry dimension="AVOID_FIRE">6.000000</entry>
</rawFitness></content></message>
</textarea></div>

<p>The <b>id</b> corresponds to the id of the genome. The <b>fitness</b> corresponds
to the cumulative fitness value based on the current Z-score and fitness weights
set during training. The raw fitness dimensions are average fitness values in each of
the fitness dimensions.</p>

<p>So basically a population consists of one or more genomes. Each genome starts with
a <strong>genomestart</strong> (followed by its ID) line and ends with
a <strong>genomeend</strong> line. Between these lines, there are one or more trait lines
followed by one or more input (sensor) lines, followed by some other node lines, followed
by the gene lines.</p>

<p>For RL teams, the file looks like this:

<pre>22 serialization::archive 5 0 0 0.8 0.8 0.1 3 3 ... 1 7 27 OpenNero::TableApproximator 1 0
0 0 0 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 18 0 ...

22 serialization::archive 5 0 0 0.8 0.8 0.1 3 3 ... 1 7 27 OpenNero::TableApproximator 1 0
0 0 0 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 18 0 ...

...
</pre>

<p>Each team member is represented by a bunch of numbers representing the stored Q table
for the agent. Unlike rtNEAT teams, RL agents in this file are separated by one blank
line.

<p>Either way, you will probably want to pick and choose the individual agents from your
training episodes that perform the best for the tasks you anticipate. You should assemble
these agents into one file to submit to the tournament.

<p>Please, separate all agents in your submission file with one blank line.

<h3>6. See how your team performs in an actual game.</h3>
<I>You don't have to wait until you are done to do this, but you will at least want to have agents that do something before you try (unless you are just curious).</I>

<p>To see a team play an actual game instead of just watching it train load the <tt>NERO Battle</tt> module instead of <tt>NERO Training</tt>.  You will see a window with the arena, and a dialog box that will let you load a red team and a blue team.  You can pit your own teams against each other, or see how you do against a <A HREF="http://www.cs.utexas.edu/users/risto/cs343/private/hw6/teams">team from a previous tournament</A>.  Don't spend too much time on this, as no training is taking place in battle mode.  However this mode will allow you to confirm that you team ats intelligently against opponents that move around, and that the agents that you have choosen work well together.

<p>
<h3>7. Report</h3>
Write a detailed report highlighting the strategy/approach you took for training the teams.
Clearly explain the reasoning behind the parameter settings at each training step.
What methods did you end up using during your training? How did you test your team's
behavior?

The report will carry significant weight during grade assignment.

<p>
<h3>8. What to do with your finished team</h3>

<A HREF="http://www.cs.utexas.edu/users/risto/cs343/turnin.html"><TT>Turnin</TT></A> a directory containing:
<ul>
  <li>Your final tournament team file named as follows: TournamentTeam-$USER.txt, where $USER is the username(s) of trainer(s) of the team.</li>
  <li>Your final report summarizing what strategy you used and how you proceeded with the training, named as follows: TournamentReport-$USER.pdf</li>
  <li>Any intermediate trained teams, for example: flaggers1.txt or cowards5.txt. Don't worry about naming these anyting special unless you refer to them in your report.</li>
</ul>
  
<p>Your team and your report should be turned in seperately, however your other files can (and probably should) be turned in as a <tt>.zip/.tar.gz/etc</tt> file.  The <tt>turnin</tt> command is as follows: <tt>turnin --submit houck cs343-hw6 [filename]</tt>

